<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: layout(~{::content})}">

<div th:fragment="content">


    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="mb-0" th:text="${trip.city}"></h2>

        <div class="d-flex gap-2">
            <a th:href="@{/trips/{id}/plan(id=${trip.id})}"
               class="btn btn-outline-primary">
                Trip Plan
            </a>

            <a th:href="@{/trips/{id}/edit(id=${trip.id})}"
               class="btn btn-outline-secondary">
                Edit
            </a>

            <form th:action="@{/trips/{id}/delete(id=${trip.id})}"
                  method="post"
                  th:csrf>

                <button type="submit"
                        class="btn btn-sm btn-outline-danger"
                        onclick="return confirm('Are you sure you want to delete this trip?')">
                    Delete
                </button>
            </form>
        </div>
    </div>


    <div class="card shadow-sm mb-4">
        <div class="card-body">
            <p class="mb-1">
                <strong>Start date:</strong>
                <span th:text="${trip.startDate}"></span>
            </p>
            <p class="mb-0">
                <strong>End date:</strong>
                <span th:text="${trip.endDate}"></span>
            </p>
        </div>
    </div>


    <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="mb-0">Activities</h4>

        <a th:href="@{/trips/{tripId}/activities/create(tripId=${trip.id})}"
           class="btn btn-success btn-sm">
            + Add Activity
        </a>
    </div>


    <div th:if="${trip.activitiesByDate.isEmpty()}">
        <div class="alert alert-secondary">
            No activities yet.
        </div>
    </div>


    <div th:each="entry : ${trip.activitiesByDate}"
         class="mb-4">

        <h6 class="text-muted mb-2"
            th:text="${entry.key}">
        </h6>

        <div class="card shadow-sm">
            <ul class="list-group list-group-flush">

                <li th:each="act : ${entry.value}"
                    class="list-group-item d-flex justify-content-between align-items-center">

                    <strong th:text="${act.name}"></strong>

                    <div class="text-muted small">
                        <span th:text="${act.startTime}"></span>
                        â€”
                        <span th:text="${act.endTime}"></span>
                    </div>


                    <div class="small text-muted mt-1"
                         th:if="${act.note}"
                         th:text="${act.note}">
                    </div>


                    <div class="d-flex gap-2 align-items-center">

                        <a class="btn btn-sm btn-outline-secondary"
                           th:href="@{/trips/{tripId}/activities/{actId}/edit(tripId=${trip.id}, actId=${act.id})}">
                            Edit
                        </a>

                        <form th:action="@{/trips/{tripId}/activities/{actId}/delete(tripId=${trip.id}, actId=${act.id})}"
                              method="post"
                              th:csrf>

                            <button type="submit"
                                    class="btn btn-sm btn-outline-danger"
                                    onclick="return confirm('Are you sure you want to delete this activity?')">
                                Delete
                            </button>
                        </form>
                    </div>


                </li>

            </ul>
        </div>
    </div>

</div>
</html>